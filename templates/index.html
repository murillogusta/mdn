<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Monitoramento de Desastres Naturais (M.D.N.) ‚Äî Brasil</title>

    <!-- Leaflet CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      crossorigin=""
    />
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />

    <style>
      body {
        margin: 0;
        font-family: "Segoe UI", Arial, sans-serif;
        background-color: #f5f8fa;
        color: #222;
        line-height: 1.6;
      }
      header {
        background: linear-gradient(90deg, #004d7a, #008793, #00bf72);
        color: #fff;
        padding: 20px 24px;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }
      .logo { display:flex; align-items:center; gap:10px; }
      .logo-icon { background:white; color:#2f7a6f; border-radius:50%; width:32px; height:32px; display:flex; align-items:center; justify-content:center; }
      #map { height: 500px; width: 90%; max-width: 1200px; margin: 20px auto; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); border: 2px solid #cde5dd; }
      .controls { max-width:1000px; margin: 12px auto; display:flex; gap:10px; align-items:center; justify-content:center; flex-wrap:wrap; }
      select, input { padding:8px; border-radius:6px; border:1px solid #ccc; }
      button { padding:8px 12px; border-radius:6px; border:none; background:#2f7a6f; color:white; cursor:pointer; }
      table {width: 100%; max-width: 900px; margin: 0 auto; border-collapse: collapse; background: #fff; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.06);}
      th { background: #e4f1ed; padding: 10px; border-bottom: 1px solid #cde5dd; text-align:center; }
      td { padding: 10px; border-bottom: 1px solid #f0f0f0; text-align:center; }
      .container {max-width: 900px; margin: 0 auto 30px auto;}
      .table-container {max-height: 260px; overflow-y: auto; border-radius: 10px; margin: 0 auto; width: 90%; max-width: 900px;}
      footer { background-color: #003c5a; color: #ddd; text-align: center; padding: 15px; font-size: 0.9em; margin-top: 40px; }


      

      /* ======== Card de Estado (compacto e m√≥vel) ======== */
.disaster-card {
  position: absolute;
  background: #ffffff;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  padding: 16px 20px;
  width: 260px;
  z-index: 1000;
  font-family: "Segoe UI", sans-serif;
  color: #222;
  animation: fadeIn 0.25s ease-out;
  border: 1px solid #dbe7e3;
}

.disaster-card h3 {
  margin: 0 0 8px 0;
  color: #008793;
  font-size: 1.1em;
  text-align: center;
}

.disaster-card div {
  margin-bottom: 4px;
  font-size: 0.9em;
}

.disaster-card hr {
  border: 0;
  border-top: 1px solid #eee;
  margin: 6px 0;
}

/* Anima√ß√£o para aparecer */
@keyframes fadeInCard {
  from { opacity: 0; transform: scale(0.9); }
  to { opacity: 1; transform: scale(1); }
}

/* Anima√ß√£o para desaparecer */
@keyframes fadeOutCard {
  from { opacity: 1; transform: scale(1); }
  to { opacity: 0; transform: scale(0.9); }
}

.disaster-card {
  position: absolute;
  background: #ffffff;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  padding: 16px 20px;
  width: 260px;
  z-index: 1000;
  font-family: "Segoe UI", sans-serif;
  color: #222;
  border: 1px solid #dbe7e3;

  /* anima√ß√£o inicial */
  opacity: 0;
  transform: scale(0.9);
  animation: fadeInCard 0.25s forwards;
}

.disaster-card.fade-out {
  animation: fadeOutCard 0.25s forwards;
}

.custom-popup .leaflet-popup-content-wrapper {
  background: transparent;
  border: none;
  box-shadow: none;
  padding: 0;
}

.custom-popup .leaflet-popup-tip {
  background: transparent;
}

.custom-popup .leaflet-popup-content {
  margin: 0;
  padding: 0;
}

/* Remove fundo e borda do popup do Leaflet */
.leaflet-popup-content-wrapper,
.custom-popup .leaflet-popup-content-wrapper {
  background: transparent;
  border: none;
  box-shadow: none;
  padding: 0;
}

/* Remove a ponta do popup */
.leaflet-popup-tip,
.custom-popup .leaflet-popup-tip {
  background: transparent;
}

/* Ajusta conte√∫do interno */
.leaflet-popup-content,
.custom-popup .leaflet-popup-content {
  margin: 0;
  padding: 0;
}

.map-filter-box {
  margin: 10px auto;
  padding: 10px 15px;
  background: #ffffff;
  width: 90%;
  max-width: 1200px;
  border-radius: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  display: flex;
  gap: 12px;
  justify-content: center;
  flex-wrap: wrap;
}

.map-filter-box label {
  display: flex;
  flex-direction: column;
  font-size: 14px;
  color: #333;
}

.map-filter-box select,
.map-filter-box input {
  padding: 6px;
  border-radius: 6px;
  border: 1px solid #bbb;
  min-width: 120px;
}



    </style>
  </head>

  <body>
    <header>
      <div class="logo">
        <div class="logo-icon">üåé</div>
        <div>
          <div style="font-weight:700;">M.D.N. ‚Äî Brasil</div>
          <div style="font-size:12px;">Monitoramento de Desastres Naturais</div>
        </div>
      </div>
    </header>

    <h1 style="text-align:center; margin-top:18px;">Visualiza√ß√£o de Desastres por Munic√≠pio</h1>

    <div id="mapFilters" class="map-filter-box">
  <label>Ano (mapa):
  <select id="mapAnoFilter" multiple style="min-width:120px;">
    <option value="">Todos</option>
  </select>
</label>


  <label>Estado:
    <select id="mapEstadoFilter">
      <option value="">Todos</option>
    </select>
  </label>
</div>

    <div id="map"></div>



    <!-- filtros mais detalhados (estado / cidade / ano espec√≠fico para tabela) -->
    <div class="controls">
      <label>Estado:
        <select id="estadoFilter">
          <option value="">Todos</option>
        </select>
      </label>

      <label>Munic√≠pio:
        <select id="municipioFilter">
          <option value="">Todos</option>
        </select>
      </label>

      <label>Ano (tabela):
        <select id="anoFilter">
          <option value="">Todos</option>
        </select>
      </label>

      <button id="applyFilters">Aplicar filtros</button>
      <button id="clearFilters" style="background:#999;">Limpar</button>
    </div>

    <h2 style="text-align:center;">Lista de Registros</h2>
    <div class="container">
      <div class="table-container">
      <table id="disasterTable">
        <thead>
          <tr>
            <th>Ano</th>
            <th>Munic√≠pio</th>
            <th>Estado</th>
            <th>Tipologia / Evento</th>
            <th>Grupo</th>
            <th>FERIDOS</th>
            <th>MORTOS</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      </div>
    </div>

    <h2 style="text-align:center;">Quantidade de eventos por ano</h2>
    <div style="margin-left: 350px; width: 725px; max-width: 100%;">
      <canvas id="barChart" width="800" height="300"></canvas>
    </div>
    <!-- abaixo do canvas do gr√°fico -->
    <div id="resultado_analise" style="max-width:900px; margin: 10px auto;"></div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{{ url_for('static', filename='app.js') }}"></script>

    <footer>
      ¬© 2025 ‚Äî Monitoramento de Desastres Naturais (M.D.N.) | Desenvolvido para pesquisa e preven√ß√£o
    </footer>
  </body>
</html>
